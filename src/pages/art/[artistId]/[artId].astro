---
import { ArrowButton } from "@components/ArrowButton";
import Layout from "@layouts/Layout.astro";
import { getArtById } from "@lib/server";

const { artistId, artId } = Astro.params;

if (typeof artId !== "string" || typeof artistId !== "string") {
  return Astro.redirect("/500");
}

const { art, artist, images } = await getArtById(artId, artistId);

if (art === undefined || artist === undefined) {
  return Astro.redirect("/404");
}
---

<Layout title={art.name}>
  <div>
    <ArrowButton
      client:load
      text={`${artist.name}의 작품 보러가기`}
      href={`/art/${art.artistId}`}
    />
  </div>
  {
    images &&
      images.map(({ url }) => (
        <img src={url} class="img drop-shadow-2xl rounded-lg" />
      ))
  }
  <div class="flex flex-col gap-[2px] mx-3 my-5">
    <h2 class="text-2xl font-extrabold">{art.name}</h2>
    <a href={`/art/${art.artistId}`} class="text-xl font-bold mb-5">
      {artist.name}
    </a>
    <p>{art.description}</p>
  </div>
</Layout>
